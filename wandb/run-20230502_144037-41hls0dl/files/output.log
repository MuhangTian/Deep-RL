
[INFO:2023-05-02 14:40:47,442] Frame 640 @ 85.4 FPS | Updates 1: pg_loss 2411.614 | value_loss 18009.744 | mean_return 0.312
[INFO:2023-05-02 14:40:53,919] Frame 1280 @ 98.8 FPS | Updates 2: pg_loss 4766.239 | value_loss 107961.078 | mean_return 1.047
[INFO:2023-05-02 14:41:00,759] Frame 1920 @ 93.6 FPS | Updates 3: pg_loss 1021.853 | value_loss 18450.936 | mean_return 0.281
[INFO:2023-05-02 14:41:07,347] Frame 2560 @ 97.1 FPS | Updates 4: pg_loss 2547.366 | value_loss 23698.357 | mean_return 0.281
[INFO:2023-05-02 14:41:14,024] Frame 3200 @ 95.9 FPS | Updates 5: pg_loss 3460.216 | value_loss 59653.379 | mean_return 0.719
[INFO:2023-05-02 14:41:20,615] Frame 3840 @ 97.1 FPS | Updates 6: pg_loss 1477.118 | value_loss 11511.872 | mean_return 0.250
[INFO:2023-05-02 14:41:26,808] Frame 4480 @ 103.4 FPS | Updates 7: pg_loss 2918.972 | value_loss 44353.035 | mean_return 0.516
[INFO:2023-05-02 14:41:33,187] Frame 5120 @ 100.3 FPS | Updates 8: pg_loss 1607.297 | value_loss 28711.928 | mean_return 0.391
[INFO:2023-05-02 14:41:39,291] Frame 5760 @ 104.9 FPS | Updates 9: pg_loss 2100.500 | value_loss 19973.318 | mean_return 0.312
[INFO:2023-05-02 14:41:45,472] Frame 6400 @ 103.5 FPS | Updates 10: pg_loss 2186.378 | value_loss 31452.895 | mean_return 0.578
[INFO:2023-05-02 14:41:51,505] Frame 7040 @ 106.1 FPS | Updates 11: pg_loss 1605.794 | value_loss 21701.537 | mean_return 0.297
[INFO:2023-05-02 14:41:57,115] Frame 7680 @ 114.1 FPS | Updates 12: pg_loss 1945.936 | value_loss 22687.098 | mean_return 0.328
[INFO:2023-05-02 14:42:02,857] Frame 8320 @ 111.5 FPS | Updates 13: pg_loss 4244.992 | value_loss 78432.266 | mean_return 0.672
[INFO:2023-05-02 14:42:09,254] Frame 8960 @ 100.1 FPS | Updates 14: pg_loss 2593.564 | value_loss 46267.297 | mean_return 0.594
[INFO:2023-05-02 14:42:14,883] Frame 9600 @ 113.7 FPS | Updates 15: pg_loss 1356.921 | value_loss 10810.469 | mean_return 0.203
[INFO:2023-05-02 14:42:20,410] Frame 10240 @ 115.8 FPS | Updates 16: pg_loss 2970.102 | value_loss 45492.043 | mean_return 0.578
[INFO:2023-05-02 14:42:26,081] Frame 10880 @ 112.9 FPS | Updates 17: pg_loss 2672.614 | value_loss 50682.309 | mean_return 0.500
[INFO:2023-05-02 14:42:32,647] Frame 11520 @ 97.5 FPS | Updates 18: pg_loss 2876.453 | value_loss 61520.414 | mean_return 0.516
[INFO:2023-05-02 14:42:38,965] Frame 12160 @ 101.3 FPS | Updates 19: pg_loss 1847.936 | value_loss 31626.668 | mean_return 0.422
[INFO:2023-05-02 14:42:44,873] Frame 12800 @ 108.3 FPS | Updates 20: pg_loss 2776.047 | value_loss 36084.629 | mean_return 0.484
[INFO:2023-05-02 14:42:50,848] Frame 13440 @ 107.1 FPS | Updates 21: pg_loss 2975.535 | value_loss 61926.012 | mean_return 0.672
[INFO:2023-05-02 14:42:56,816] Frame 14080 @ 107.2 FPS | Updates 22: pg_loss 2290.342 | value_loss 62880.035 | mean_return 0.438
[INFO:2023-05-02 14:43:03,269] Frame 14720 @ 99.2 FPS | Updates 23: pg_loss 2685.124 | value_loss 41412.129 | mean_return 0.547
[INFO:2023-05-02 14:43:09,597] Frame 15360 @ 101.1 FPS | Updates 24: pg_loss 3044.946 | value_loss 66142.008 | mean_return 0.625
[INFO:2023-05-02 14:43:15,599] Frame 16000 @ 106.7 FPS | Updates 25: pg_loss 923.221 | value_loss 9300.429 | mean_return 0.219
[INFO:2023-05-02 14:43:21,415] Frame 16640 @ 110.0 FPS | Updates 26: pg_loss 2431.463 | value_loss 27381.303 | mean_return 0.438
[INFO:2023-05-02 14:43:27,001] Frame 17280 @ 114.6 FPS | Updates 27: pg_loss 2851.747 | value_loss 40313.840 | mean_return 0.609
[INFO:2023-05-02 14:43:32,598] Frame 17920 @ 114.4 FPS | Updates 28: pg_loss 693.228 | value_loss 6913.472 | mean_return 0.281
[INFO:2023-05-02 14:43:38,001] Frame 18560 @ 118.5 FPS | Updates 29: pg_loss 1800.604 | value_loss 24732.438 | mean_return 0.344
[INFO:2023-05-02 14:43:43,660] Frame 19200 @ 113.1 FPS | Updates 30: pg_loss 2625.550 | value_loss 43851.312 | mean_return 0.625
[INFO:2023-05-02 14:43:50,407] Frame 19840 @ 94.9 FPS | Updates 31: pg_loss 858.429 | value_loss 14391.906 | mean_return 0.234
[INFO:2023-05-02 14:43:56,365] Frame 20480 @ 107.4 FPS | Updates 32: pg_loss 1392.330 | value_loss 10365.595 | mean_return 0.250
[INFO:2023-05-02 14:44:02,187] Frame 21120 @ 109.9 FPS | Updates 33: pg_loss 2444.944 | value_loss 35415.289 | mean_return 0.516
[INFO:2023-05-02 14:44:08,277] Frame 21760 @ 105.1 FPS | Updates 34: pg_loss 1449.906 | value_loss 41489.492 | mean_return 0.328
[INFO:2023-05-02 14:44:14,607] Frame 22400 @ 101.1 FPS | Updates 35: pg_loss 2338.393 | value_loss 27446.316 | mean_return 0.422
[INFO:2023-05-02 14:44:20,333] Frame 23040 @ 111.8 FPS | Updates 36: pg_loss 2546.619 | value_loss 47769.523 | mean_return 0.703
[INFO:2023-05-02 14:44:26,319] Frame 23680 @ 106.9 FPS | Updates 37: pg_loss 2299.781 | value_loss 72378.695 | mean_return 0.500
[INFO:2023-05-02 14:44:31,913] Frame 24320 @ 114.4 FPS | Updates 38: pg_loss 1767.934 | value_loss 18591.627 | mean_return 0.375
[INFO:2023-05-02 14:44:37,489] Frame 24960 @ 114.8 FPS | Updates 39: pg_loss 3515.981 | value_loss 82535.258 | mean_return 0.703
[INFO:2023-05-02 14:44:43,018] Frame 25600 @ 115.8 FPS | Updates 40: pg_loss 1185.631 | value_loss 23259.246 | mean_return 0.344
[INFO:2023-05-02 14:44:49,275] Frame 26240 @ 102.3 FPS | Updates 41: pg_loss 1505.664 | value_loss 25017.805 | mean_return 0.375
[INFO:2023-05-02 14:44:55,018] Frame 26880 @ 111.5 FPS | Updates 42: pg_loss 3597.454 | value_loss 61976.379 | mean_return 0.766
[INFO:2023-05-02 14:45:01,014] Frame 27520 @ 106.7 FPS | Updates 43: pg_loss 1795.297 | value_loss 27440.611 | mean_return 0.453
[INFO:2023-05-02 14:45:06,873] Frame 28160 @ 109.2 FPS | Updates 44: pg_loss 2079.166 | value_loss 34462.109 | mean_return 0.438
[INFO:2023-05-02 14:45:12,426] Frame 28800 @ 115.3 FPS | Updates 45: pg_loss 3288.321 | value_loss 71902.406 | mean_return 0.641
[INFO:2023-05-02 14:45:18,420] Frame 29440 @ 106.8 FPS | Updates 46: pg_loss 1083.156 | value_loss 9520.359 | mean_return 0.297
[INFO:2023-05-02 14:45:24,732] Frame 30080 @ 101.4 FPS | Updates 47: pg_loss 2588.978 | value_loss 51291.469 | mean_return 0.531
[INFO:2023-05-02 14:45:30,729] Frame 30720 @ 106.7 FPS | Updates 48: pg_loss 2599.118 | value_loss 52428.695 | mean_return 0.562
[INFO:2023-05-02 14:45:36,812] Frame 31360 @ 105.2 FPS | Updates 49: pg_loss 2038.160 | value_loss 43860.379 | mean_return 0.438
[INFO:2023-05-02 14:45:42,182]
*** Saving checkpoint to trained/a2c_lstm.pt ***
[INFO:2023-05-02 14:45:42,352] Frame 32000 @ 115.5 FPS | Updates 50: pg_loss 2566.907 | value_loss 42373.453 | mean_return 0.469
Traceback (most recent call last):
  File "/Users/mt361/Desktop/RL-Bandits/train.py", line 55, in <module>
    algo.train()
  File "/Users/mt361/Desktop/RL-Bandits/algo.py", line 348, in train
    utils.validate(model, args.render, nepisodes=5, wandb=wandb)
  File "/Users/mt361/Desktop/RL-Bandits/utils.py", line 69, in validate
    action, prev_state = model.get_action(observation, prev_state)
  File "/Users/mt361/Desktop/RL-Bandits/model.py", line 132, in get_action
    logits, prev_state = self(x, prev_state)
  File "/usr/local/anaconda3/envs/RL/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/mt361/Desktop/RL-Bandits/model.py", line 125, in forward
    Z, prev_state = self.lstm(Z, prev_state)
  File "/usr/local/anaconda3/envs/RL/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/anaconda3/envs/RL/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 810, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/usr/local/anaconda3/envs/RL/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 731, in check_forward_args
    self.check_hidden_size(hidden[0], self.get_expected_hidden_size(input, batch_sizes),
  File "/usr/local/anaconda3/envs/RL/lib/python3.9/site-packages/torch/nn/modules/rnn.py", line 239, in check_hidden_size
    raise RuntimeError(msg.format(expected_hidden_size, list(hx.size())))
RuntimeError: Expected hidden[0] size (1, 1, 256), got [1, 8, 256]